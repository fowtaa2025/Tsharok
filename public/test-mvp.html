<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MVP Testing Dashboard - Tsharok</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        .test-card {
            transition: all 0.3s ease;
        }
        .test-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .status-pending { color: #6b7280; }
        .status-running { color: #3b82f6; }
        .status-success { color: #10b981; }
        .status-error { color: #ef4444; }
    </style>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen py-8">
        <div class="max-w-7xl mx-auto px-4">
            <!-- Header -->
            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg shadow-xl p-8 text-white mb-8">
                <h1 class="text-4xl font-bold mb-2">
                    <i class="fas fa-vial mr-3"></i>
                    Tsharok MVP Testing Dashboard
                </h1>
                <p class="text-indigo-100">Comprehensive testing of all MVP features</p>
            </div>

            <!-- Quick Actions -->
            <div class="grid md:grid-cols-4 gap-4 mb-8">
                <button onclick="runAllTests()" class="bg-indigo-600 text-white px-6 py-4 rounded-lg hover:bg-indigo-700 flex items-center justify-center gap-2 font-semibold">
                    <i class="fas fa-play"></i>
                    Run All Tests
                </button>
                <a href="index.html" class="bg-blue-600 text-white px-6 py-4 rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 font-semibold">
                    <i class="fas fa-home"></i>
                    Homepage
                </a>
                <a href="search-results.html" class="bg-green-600 text-white px-6 py-4 rounded-lg hover:bg-green-700 flex items-center justify-center gap-2 font-semibold">
                    <i class="fas fa-search"></i>
                    Search Page
                </a>
                <a href="test-rtl.html" class="bg-purple-600 text-white px-6 py-4 rounded-lg hover:bg-purple-700 flex items-center justify-center gap-2 font-semibold">
                    <i class="fas fa-globe"></i>
                    RTL Test
                </a>
            </div>

            <!-- Test Results Grid -->
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Test 1: Server & Database -->
                <div class="test-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-900">
                            <i class="fas fa-server mr-2 text-indigo-600"></i>
                            Server & Database
                        </h3>
                        <span id="test1-status" class="status-pending">
                            <i class="fas fa-circle text-xs"></i>
                        </span>
                    </div>
                    <p class="text-gray-600 mb-4">Testing server connection and database availability</p>
                    <button onclick="testServerDB()" class="bg-indigo-100 text-indigo-700 px-4 py-2 rounded hover:bg-indigo-200">
                        <i class="fas fa-play mr-2"></i>Run Test
                    </button>
                    <div id="test1-result" class="mt-4 hidden">
                        <div class="bg-gray-50 rounded p-3 text-sm">
                            <pre id="test1-output" class="whitespace-pre-wrap"></pre>
                        </div>
                    </div>
                </div>

                <!-- Test 2: Search Functionality -->
                <div class="test-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-900">
                            <i class="fas fa-search mr-2 text-blue-600"></i>
                            Search Functionality
                        </h3>
                        <span id="test2-status" class="status-pending">
                            <i class="fas fa-circle text-xs"></i>
                        </span>
                    </div>
                    <p class="text-gray-600 mb-4">Testing course search, filters, and sorting</p>
                    <button onclick="testSearch()" class="bg-blue-100 text-blue-700 px-4 py-2 rounded hover:bg-blue-200">
                        <i class="fas fa-play mr-2"></i>Run Test
                    </button>
                    <div id="test2-result" class="mt-4 hidden">
                        <div class="bg-gray-50 rounded p-3 text-sm">
                            <pre id="test2-output" class="whitespace-pre-wrap"></pre>
                        </div>
                    </div>
                </div>

                <!-- Test 3: Course Browsing -->
                <div class="test-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-900">
                            <i class="fas fa-book mr-2 text-green-600"></i>
                            Course Browsing
                        </h3>
                        <span id="test3-status" class="status-pending">
                            <i class="fas fa-circle text-xs"></i>
                        </span>
                    </div>
                    <p class="text-gray-600 mb-4">Testing course listing and details pages</p>
                    <button onclick="testCourseBrowsing()" class="bg-green-100 text-green-700 px-4 py-2 rounded hover:bg-green-200">
                        <i class="fas fa-play mr-2"></i>Run Test
                    </button>
                    <div id="test3-result" class="mt-4 hidden">
                        <div class="bg-gray-50 rounded p-3 text-sm">
                            <pre id="test3-output" class="whitespace-pre-wrap"></pre>
                        </div>
                    </div>
                </div>

                <!-- Test 4: Rating System -->
                <div class="test-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-900">
                            <i class="fas fa-star mr-2 text-yellow-500"></i>
                            Rating System
                        </h3>
                        <span id="test4-status" class="status-pending">
                            <i class="fas fa-circle text-xs"></i>
                        </span>
                    </div>
                    <p class="text-gray-600 mb-4">Testing ratings and review functionality</p>
                    <button onclick="testRatings()" class="bg-yellow-100 text-yellow-700 px-4 py-2 rounded hover:bg-yellow-200">
                        <i class="fas fa-play mr-2"></i>Run Test
                    </button>
                    <div id="test4-result" class="mt-4 hidden">
                        <div class="bg-gray-50 rounded p-3 text-sm">
                            <pre id="test4-output" class="whitespace-pre-wrap"></pre>
                        </div>
                    </div>
                </div>

                <!-- Test 5: Multilingual & RTL -->
                <div class="test-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-900">
                            <i class="fas fa-globe mr-2 text-purple-600"></i>
                            Multilingual & RTL
                        </h3>
                        <span id="test5-status" class="status-pending">
                            <i class="fas fa-circle text-xs"></i>
                        </span>
                    </div>
                    <p class="text-gray-600 mb-4">Testing English/Arabic toggle and RTL layout</p>
                    <button onclick="testI18n()" class="bg-purple-100 text-purple-700 px-4 py-2 rounded hover:bg-purple-200">
                        <i class="fas fa-play mr-2"></i>Run Test
                    </button>
                    <div id="test5-result" class="mt-4 hidden">
                        <div class="bg-gray-50 rounded p-3 text-sm">
                            <pre id="test5-output" class="whitespace-pre-wrap"></pre>
                        </div>
                    </div>
                </div>

                <!-- Test 6: Responsive Design -->
                <div class="test-card bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-gray-900">
                            <i class="fas fa-mobile-alt mr-2 text-pink-600"></i>
                            Responsive Design
                        </h3>
                        <span id="test6-status" class="status-pending">
                            <i class="fas fa-circle text-xs"></i>
                        </span>
                    </div>
                    <p class="text-gray-600 mb-4">Testing mobile, tablet, and desktop layouts</p>
                    <button onclick="testResponsive()" class="bg-pink-100 text-pink-700 px-4 py-2 rounded hover:bg-pink-200">
                        <i class="fas fa-play mr-2"></i>Run Test
                    </button>
                    <div id="test6-result" class="mt-4 hidden">
                        <div class="bg-gray-50 rounded p-3 text-sm">
                            <pre id="test6-output" class="whitespace-pre-wrap"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Overall Results -->
            <div id="overall-results" class="mt-8 bg-white rounded-lg shadow-md p-6 hidden">
                <h3 class="text-2xl font-bold mb-4">
                    <i class="fas fa-chart-pie mr-2 text-indigo-600"></i>
                    Test Summary
                </h3>
                <div class="grid md:grid-cols-4 gap-4">
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <div class="text-3xl font-bold text-gray-900" id="total-tests">0</div>
                        <div class="text-sm text-gray-600">Total Tests</div>
                    </div>
                    <div class="bg-green-50 rounded-lg p-4 text-center">
                        <div class="text-3xl font-bold text-green-600" id="passed-tests">0</div>
                        <div class="text-sm text-gray-600">Passed</div>
                    </div>
                    <div class="bg-red-50 rounded-lg p-4 text-center">
                        <div class="text-3xl font-bold text-red-600" id="failed-tests">0</div>
                        <div class="text-sm text-gray-600">Failed</div>
                    </div>
                    <div class="bg-indigo-50 rounded-lg p-4 text-center">
                        <div class="text-3xl font-bold text-indigo-600" id="success-rate">0%</div>
                        <div class="text-sm text-gray-600">Success Rate</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/axios-config.js"></script>
    <script>
        let testResults = {};

        function updateStatus(testId, status, output = '') {
            const statusEl = document.getElementById(`test${testId}-status`);
            const resultEl = document.getElementById(`test${testId}-result`);
            const outputEl = document.getElementById(`test${testId}-output`);
            
            statusEl.className = `status-${status}`;
            statusEl.innerHTML = status === 'running' ? '<i class="fas fa-spinner fa-spin"></i>' :
                                status === 'success' ? '<i class="fas fa-check-circle"></i>' :
                                status === 'error' ? '<i class="fas fa-times-circle"></i>' :
                                '<i class="fas fa-circle text-xs"></i>';
            
            if (output) {
                resultEl.classList.remove('hidden');
                outputEl.textContent = output;
            }
            
            testResults[testId] = status === 'success';
            updateOverallResults();
        }

        async function testServerDB() {
            updateStatus(1, 'running');
            try {
                const response = await axios.get('/api/majors.php');
                if (response.data.success) {
                    updateStatus(1, 'success', '✓ Server is running\n✓ Database connection OK\n✓ API responding correctly');
                } else {
                    updateStatus(1, 'error', '✗ API returned success: false');
                }
            } catch (error) {
                updateStatus(1, 'error', '✗ Error: ' + error.message);
            }
        }

        async function testSearch() {
            updateStatus(2, 'running');
            try {
                const response = await axios.get('/api/search.php?q=programming');
                if (response.data.success && response.data.data.courses) {
                    const courses = response.data.data.courses;
                    updateStatus(2, 'success', 
                        `✓ Search API working\n✓ Found ${courses.length} courses\n✓ FULLTEXT search operational`);
                } else {
                    updateStatus(2, 'error', '✗ Invalid API response');
                }
            } catch (error) {
                updateStatus(2, 'error', '✗ Error: ' + error.message);
            }
        }

        async function testCourseBrowsing() {
            updateStatus(3, 'running');
            try {
                const [allCourses, courseDetails] = await Promise.all([
                    axios.get('/api/search.php'),
                    axios.get('/api/course-details.php?id=13')
                ]);
                
                if (allCourses.data.success && courseDetails.data.success) {
                    updateStatus(3, 'success', 
                        `✓ Course listing works\n✓ Course details page works\n✓ Total courses: ${allCourses.data.data.pagination.totalResults}`);
                } else {
                    updateStatus(3, 'error', '✗ One or more endpoints failed');
                }
            } catch (error) {
                updateStatus(3, 'error', '✗ Error: ' + error.message);
            }
        }

        async function testRatings() {
            updateStatus(4, 'running');
            try {
                const [ratings, comments] = await Promise.all([
                    axios.get('/api/ratings.php?courseId=13'),
                    axios.get('/api/comments.php?courseId=13')
                ]);
                
                if (ratings.data.success && comments.data.success) {
                    updateStatus(4, 'success', 
                        `✓ Rating system initialized\n✓ Review system functional\n✓ Database schema correct`);
                } else {
                    updateStatus(4, 'error', '✗ Rating API not responding correctly');
                }
            } catch (error) {
                updateStatus(4, 'error', '✗ Error: ' + error.message);
            }
        }

        function testI18n() {
            updateStatus(5, 'running');
            setTimeout(() => {
                const hasI18n = typeof window.t === 'function';
                const hasRTL = document.querySelector('link[href*="rtl.css"]') !== null;
                
                if (hasI18n && hasRTL) {
                    updateStatus(5, 'success', 
                        '✓ i18n.js loaded\n✓ RTL CSS available\n✓ Language toggle functional');
                } else {
                    updateStatus(5, 'error', 
                        `✗ i18n: ${hasI18n ? 'OK' : 'Missing'}\n✗ RTL: ${hasRTL ? 'OK' : 'Missing'}`);
                }
            }, 500);
        }

        function testResponsive() {
            updateStatus(6, 'running');
            setTimeout(() => {
                const viewport = window.innerWidth;
                const hasTailwind = document.querySelector('script[src*="tailwindcss"]') !== null;
                const deviceType = viewport < 768 ? 'Mobile' : viewport < 1024 ? 'Tablet' : 'Desktop';
                
                if (hasTailwind) {
                    updateStatus(6, 'success', 
                        `✓ Tailwind CSS loaded\n✓ Viewport: ${viewport}px (${deviceType})\n✓ Responsive classes active`);
                } else {
                    updateStatus(6, 'error', '✗ Tailwind CSS not found');
                }
            }, 500);
        }

        function updateOverallResults() {
            const resultsDiv = document.getElementById('overall-results');
            const total = Object.keys(testResults).length;
            const passed = Object.values(testResults).filter(r => r === true).length;
            const failed = Object.values(testResults).filter(r => r === false).length;
            const rate = total > 0 ? Math.round((passed / total) * 100) : 0;
            
            if (total > 0) {
                resultsDiv.classList.remove('hidden');
                document.getElementById('total-tests').textContent = total;
                document.getElementById('passed-tests').textContent = passed;
                document.getElementById('failed-tests').textContent = failed;
                document.getElementById('success-rate').textContent = rate + '%';
            }
        }

        async function runAllTests() {
            testResults = {};
            await testServerDB();
            await new Promise(r => setTimeout(r, 500));
            await testSearch();
            await new Promise(r => setTimeout(r, 500));
            await testCourseBrowsing();
            await new Promise(r => setTimeout(r, 500));
            await testRatings();
            await new Promise(r => setTimeout(r, 500));
            testI18n();
            await new Promise(r => setTimeout(r, 500));
            testResponsive();
        }
    </script>
</body>
</html>

