Tsharok Database Structure
==========================

ENTITY-RELATIONSHIP OVERVIEW
=============================

1. MAJORS
   - Stores academic majors/departments
   - Primary Key: id
   - Fields: name, description

2. USERS
   - Stores all system users (students, instructors, admins)
   - Primary Key: user_id
   - Foreign Keys: major_id -> majors(id)
   - Fields: username, email, password_hash, first_name, last_name, role, phone, profile_image, bio, is_active
   - Roles: student, instructor, admin

3. COURSES
   - Stores course information
   - Primary Key: course_id
   - Foreign Keys: instructor_id -> users(user_id)
   - Fields: course_code, title, description, category, level, duration_weeks, max_students, is_published, start_date, end_date, semester

4. ENROLLMENTS
   - Links students to courses with progress tracking
   - Primary Key: enrollment_id
   - Foreign Keys: student_id -> users(user_id), course_id -> courses(course_id)
   - Fields: enrollment_date, status, progress_percentage, grade, completion_date
   - Unique constraint: (student_id, course_id)

5. CONTENT
   - Stores course materials (lectures, videos, assignments, etc.)
   - Primary Key: id
   - Foreign Keys: uploader_id -> users(user_id), course_id -> courses(course_id)
   - Fields: title, type, file_url, upload_date, is_approved, description, file_size, mime_type
   - Types: lecture, assignment, video, document, quiz, other

6. RATINGS
   - User ratings on content
   - Primary Key: id
   - Foreign Keys: user_id -> users(user_id), content_id -> content(id)
   - Fields: score (0-5)
   - Unique constraint: (user_id, content_id)

7. COMMENTS
   - User comments on content
   - Primary Key: id
   - Foreign Keys: content_id -> content(id), user_id -> users(user_id)
   - Fields: content, created_at

8. DOWNLOADS
   - Tracks content downloads
   - Primary Key: id
   - Foreign Keys: user_id -> users(user_id), content_id -> content(id)
   - Fields: downloaded_at

9. ADMIN_ACTIONS
   - Logs administrative actions
   - Primary Key: id
   - Foreign Keys: admin_id -> users(user_id)
   - Fields: action_type, target_type, target_id, timestamp, description
   - Action types: create, update, delete, approve, reject, ban, unban, other
   - Target types: user, course, content, comment, other

RELATIONSHIPS
=============

User Relationships:
- User belongs to Major (N:1)
- User teaches Courses (1:N) [as instructor]
- User enrolls in Courses (N:N) [as student, through enrollments]
- User uploads Content (1:N)
- User gives Ratings (1:N)
- User writes Comments (1:N)
- User performs Downloads (1:N)
- User performs AdminActions (1:N) [as admin]

Course Relationships:
- Course has one Instructor (N:1)
- Course has many Enrollments (1:N)
- Course has many Content items (1:N)

Content Relationships:
- Content belongs to Course (N:1)
- Content uploaded by User (N:1)
- Content has many Ratings (1:N)
- Content has many Comments (1:N)
- Content has many Downloads (1:N)

Major Relationships:
- Major has many Users (1:N)

INDEXES
=======

Performance indexes created on:
- All primary keys (automatic)
- All foreign keys
- Frequently searched fields (email, username, course_code)
- Date/timestamp fields for chronological queries
- Status and type fields for filtering
- Unique constraints for data integrity

CASCADE BEHAVIORS
=================

ON DELETE CASCADE:
- enrollments -> users, courses
- content -> users, courses
- ratings -> users, content
- comments -> users, content
- downloads -> users, content
- admin_actions -> users

ON DELETE RESTRICT:
- courses -> users (instructors cannot be deleted if they have courses)

ON DELETE SET NULL:
- users -> majors (if major is deleted, user's major_id set to NULL)

